{"version":3,"sources":["webpack:///./src/pages/supporting-infrastructure/batch.mdx"],"names":["_frontmatter","makeShortcode","name","props","console","warn","InlineNotification","Tabs","Tab","Row","Column","Caption","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","mdxType","parentName","label","isMDXComponent"],"mappings":"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","file":"component---src-pages-supporting-infrastructure-batch-mdx-2ec6f7d7450eda94ec59.js","sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\n\nimport DefaultLayout from \"/home/travis/build/IBM/spm-kubernetes/node_modules/gatsby-theme-carbon/src/templates/Default.js\";\nexport const _frontmatter = {};\n\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n  return <div {...props} />;\n};\n\nconst InlineNotification = makeShortcode(\"InlineNotification\");\nconst Tabs = makeShortcode(\"Tabs\");\nconst Tab = makeShortcode(\"Tab\");\nconst Row = makeShortcode(\"Row\");\nconst Column = makeShortcode(\"Column\");\nconst Caption = makeShortcode(\"Caption\");\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h2>{`How batch streaming is deployed in IBM® Cloud™ Kubernetes Services (IKS)`}</h2>\n    <p>{`SPM on Kubernetes supports a different model for batch processing in IKS, where, as outlined earlier, SPM batch processing can be built and deployed into its own pod.\nBy running SPM batch processing in its own pod, the pod can leverage the benefits of flexibility, elasticity, efficiency and the strategic value offered by cloud native architecture.`}</p>\n    <h3>{`What is batch streaming?`}</h3>\n    <p>{`The batch streaming infrastructure provides a straightforward mechanism to implement a batch process so that it can be run in parallel (streams) across multiple pods.\nFor example, if we wanted to issue payments, the chunker identifies all the cases to be paid and the stream would process a case and issue the payments that are due.`}</p>\n    <InlineNotification mdxType=\"InlineNotification\">\n      <p><strong parentName=\"p\">{`Note:`}</strong>{` For more information, see `}<a parentName=\"p\" {...{\n          \"href\": \"https://www.ibm.com/support/knowledgecenter/SS8S5A_7.0.10/com.ibm.curam.content.doc/BatchPerformanceMechanisms/c_BATCHPER_Architecture1AdditionalInformation1.html\"\n        }}>{`Batch Streaming Architecture`}</a></p>\n    </InlineNotification>\n    <h3>{`Setting up Batch Streaming yaml files`}</h3>\n    <p>{`Outlined below is an example for the steps required to set up Batch Streaming.\nThis example uses the bulk reassessment of food assistance case types.`}</p>\n    <p>{`The first stage is to set up a new yaml file for the streaming and chunking batch processing.`}</p>\n    <InlineNotification mdxType=\"InlineNotification\">\n      <p><strong parentName=\"p\">{`Note:`}</strong>{` No SPM default installation settings were changed.`}</p>\n    </InlineNotification>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-shell\"\n      }}>{`export NAMESPACE=\nexport releasename=\nkubectl create job --from=cronjob/$releasename-batch -n $NAMESPACE -o yaml --dry-run testjob > yaml_chart_name.yaml\n`}</code></pre>\n    <InlineNotification mdxType=\"InlineNotification\">\n      <p><strong parentName=\"p\">{`Note:`}</strong>{` where`}</p>\n      <ul>\n        <li parentName=\"ul\">{`NAMESPACE is the namespace where you want to run the batch processing`}</li>\n        <li parentName=\"ul\">{`releaseName is the name of the release you are using`}</li>\n        <li parentName=\"ul\">{`yaml_chart_name is the name of the chart you are creating\nYou should create a new chart for each process, for example stream_foodassistance, and chunker_foodassistance.`}</li>\n      </ul>\n    </InlineNotification>\n    <p>{`A corresponding `}<inlineCode parentName=\"p\">{`yaml`}</inlineCode>{` file is created.\nOpen the yaml file in an editor e.g`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-shell\"\n      }}>{`vi \\`chunker_foodassistance.yaml\\`\n`}</code></pre>\n    <p>{`Add the following lines to the yaml file after the `}<inlineCode parentName=\"p\">{`containers`}</inlineCode>{` section:`}</p>\n    <Tabs mdxType=\"Tabs\">\n      <Tab label=\"Chunker\" mdxType=\"Tab\">\n        <Row mdxType=\"Row\">\n          <Column mdxType=\"Column\">\n            <pre><code parentName=\"pre\" {...{\n                \"className\": \"language-yaml\"\n              }}>{`spec:\n  backoffLimit: 5\n  template:\n    metadata:\n      creationTimestamp: null\n    spec:\n      containers:\n      - command:\n          - build.sh\n          - runbatch\n        args:\n          - -Dcuram.jmx.output_statistics_timer_enabled=true\n          - -Dcuram.jmx.output_statistics_timer_folder=/tmp\n          - -Dcuram.jmx.output_statistics_timer_period=60000\n          - -Dbatch.program=curam.core.sl.infrastructure.assessment.intf.CREOLEBulkCaseChunkReassessmentByProduct.process\n          - -Dbatch.parameters=\"productID=4200\"\n        env:\n          - name: ANT_OPTS\n            value: -Xgcpolicy:gencon -Xverbosegclog:/tmp/GCLogs_chunker.log\n        image: ......\n\n`}</code></pre>\n          </Column>\n        </Row>\n      </Tab>\n      <Tab label=\"Stream\" mdxType=\"Tab\">\n        <Row mdxType=\"Row\">\n          <Column mdxType=\"Column\">\n            <pre><code parentName=\"pre\" {...{\n                \"className\": \"language-yaml\"\n              }}>{`spec:\n  backoffLimit: 5\n  template:\n    metadata:\n      creationTimestamp: null\n    spec:\n      containers:\n      - command:\n          - build.sh\n          - runbatch\n        args:\n          - -Dcuram.jmx.output_statistics_timer_enabled=true\n          - -Dcuram.jmx.output_statistics_timer_folder=/tmp\n          - -Dcuram.jmx.output_statistics_timer_period=60000\n          - -Dbatch.program=curam.core.sl.infrastructure.assessment.intf.CREOLEBulkCaseChunkReassessmentStream.process\n        env:\n          - name: ANT_OPTS\n            value: -Xgcpolicy:gencon -Xverbosegclog:/tmp/GCLogs_stream.log\n        image: ......\n\n`}</code></pre>\n          </Column>\n        </Row>\n      </Tab>\n    </Tabs>\n    <p>{`You should now have a yaml file for a chunker and streamer for bulk reassessment of food assistance case types.`}</p>\n    <h3>{`Running batch streaming yaml files`}</h3>\n    <p>{`To orchestrate the batch process, run the following command and repeat for the chunker and streamer.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-shell\"\n      }}>{`kubectl create -f yaml_chart_name.yaml -n $NAMESPACE\n`}</code></pre>\n    <span {...{\n      \"className\": \"gatsby-resp-image-wrapper\",\n      \"style\": {\n        \"position\": \"relative\",\n        \"display\": \"block\",\n        \"marginLeft\": \"auto\",\n        \"marginRight\": \"auto\",\n        \"maxWidth\": \"702px\"\n      }\n    }}>{`\n      `}<span parentName=\"span\" {...{\n        \"className\": \"gatsby-resp-image-background-image\",\n        \"style\": {\n          \"paddingBottom\": \"54.513888888888886%\",\n          \"position\": \"relative\",\n          \"bottom\": \"0\",\n          \"left\": \"0\",\n          \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsSAAALEgHS3X78AAAB20lEQVQoz1WSXW/TMBSG8/8lfgBCIEBo3CBt46KDcYEmARtsrdqmab6z5stxSps2X47j2AnHdCvj6L3wxXns97zHyiKkOmKgZdQYYWkEuR3tzCDzknKV1ve4clDpp7WDKi166DxK0WNmYW5hYaH6xUV+8iWxTXWpaYSQYRjijH2ek4LwqiaLgJhJZyBqJoB0QClLCQsDdUZYGEEbbTgwfS8FZYX5+6t4W9C8qKdergV0GXZa2AJi40ExEHPXAt6febsDACV6Kah9Sb0oaxmvGwY9ZlpMA+/rdPJNm2sIKXceHa86M25UJ+np76mbndw0E3t3rUa063vR5fsMrJQEQmF6ii9/jM5Gpx8/nf5yxsr5uDobN2qY31lxL8itWz27KG7N7PvMb5hou2FdDoz3FWkP8Pnow9uXr969eX2t/1RmfqvF3EDtzM3AKvRRYPhAufRtIfL8cm1EdUPhZWriWovwzdIZOys92T7OjDrV2/fHoWVm8uzj4mq+ntibfV5N3f0iaCCtRUBlYOkgV2VjbmKuhxXn/SHn/jGwsmaqu013FGxrYQPredyT1L89gzchxPB/MdZu0kTeIgOjdir+Nj/oCHMjpveoWMHHeiIfV+Ga+Lh04wIGfEqC/gDSdlfqMHsS6QAAAABJRU5ErkJggg==')\",\n          \"backgroundSize\": \"cover\",\n          \"display\": \"block\"\n        }\n      }}></span>{`\n  `}<picture parentName=\"span\">{`\n        `}<source parentName=\"picture\" {...{\n          \"srcSet\": [\"/spm-kubernetes/static/2d95d0591a546fe9893ff6179ac54d2d/0eda2/spm_batch_processing_on_kubernetes.webp 288w\", \"/spm-kubernetes/static/2d95d0591a546fe9893ff6179ac54d2d/460e2/spm_batch_processing_on_kubernetes.webp 576w\", \"/spm-kubernetes/static/2d95d0591a546fe9893ff6179ac54d2d/6a980/spm_batch_processing_on_kubernetes.webp 702w\"],\n          \"sizes\": \"(max-width: 702px) 100vw, 702px\",\n          \"type\": \"image/webp\"\n        }}></source>{`\n        `}<source parentName=\"picture\" {...{\n          \"srcSet\": [\"/spm-kubernetes/static/2d95d0591a546fe9893ff6179ac54d2d/7fc1e/spm_batch_processing_on_kubernetes.png 288w\", \"/spm-kubernetes/static/2d95d0591a546fe9893ff6179ac54d2d/a5df1/spm_batch_processing_on_kubernetes.png 576w\", \"/spm-kubernetes/static/2d95d0591a546fe9893ff6179ac54d2d/254b8/spm_batch_processing_on_kubernetes.png 702w\"],\n          \"sizes\": \"(max-width: 702px) 100vw, 702px\",\n          \"type\": \"image/png\"\n        }}></source>{`\n        `}<img parentName=\"picture\" {...{\n          \"className\": \"gatsby-resp-image-image\",\n          \"src\": \"/spm-kubernetes/static/2d95d0591a546fe9893ff6179ac54d2d/254b8/spm_batch_processing_on_kubernetes.png\",\n          \"alt\": \"spm batch on kubernetes\",\n          \"title\": \"spm batch on kubernetes\",\n          \"loading\": \"lazy\",\n          \"style\": {\n            \"width\": \"100%\",\n            \"height\": \"100%\",\n            \"margin\": \"0\",\n            \"verticalAlign\": \"middle\",\n            \"position\": \"absolute\",\n            \"top\": \"0\",\n            \"left\": \"0\"\n          }\n        }}></img>{`\n      `}</picture>{`\n    `}</span>\n    <Caption mdxType=\"Caption\">\n      <p><em parentName=\"p\">{`Figure 1:`}</em>{` SPM batch processing on kubernetes`}</p>\n    </Caption>\n    <InlineNotification mdxType=\"InlineNotification\">\n      <p><strong parentName=\"p\">{`Note:`}</strong>{` where`}</p>\n      <ul>\n        <li parentName=\"ul\">{`NAMESPACE is the namespace where you want to run the batch processing.`}</li>\n        <li parentName=\"ul\">{`yaml_chart_name is the name of the chart you are creating.`}</li>\n      </ul>\n    </InlineNotification>\n    <h3>{`Post batch processing`}</h3>\n    <p>{`The batch pods that are created for batch streaming are on demand.`}</p>\n    <p>{`When the batch processes finish, the pods remain and are not shut down.\nTherefore you should destroy the related pods to free resources in the IKS cluster`}</p>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"sourceRoot":""}